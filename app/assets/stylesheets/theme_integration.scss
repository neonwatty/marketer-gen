// =============================================================================
// THEME SYSTEM INTEGRATION
// =============================================================================
// Seamless integration with existing UI components, ensuring all components
// work harmoniously with the new theme system
// =============================================================================

// =============================================================================
// EXISTING COMPONENT THEME INTEGRATION
// =============================================================================

// Dashboard components theme integration
.dashboard {
  background-color: var(--color-bg-primary);
  color: var(--color-text-primary);
  
  .dashboard-header {
    background-color: var(--color-surface-primary);
    border-bottom: 1px solid var(--color-border-primary);
    color: var(--color-text-primary);
    
    h1, h2, h3 {
      color: var(--color-text-primary);
    }
  }
  
  .dashboard-sidebar {
    background-color: var(--color-surface-secondary);
    border-right: 1px solid var(--color-border-primary);
    
    .nav-item {
      color: var(--color-text-secondary);
      border-radius: var(--radius-md);
      transition: var(--transition-colors);
      
      &:hover {
        background-color: var(--color-surface-tertiary);
        color: var(--color-text-primary);
      }
      
      &.active {
        background-color: var(--color-interactive-primary);
        color: white;
      }
    }
  }
  
  .dashboard-main {
    background-color: var(--color-bg-primary);
  }
  
  .dashboard-card {
    @extend .card;
    
    .card-header {
      background-color: var(--color-surface-primary);
      border-bottom-color: var(--color-border-primary);
    }
  }
  
  .dashboard-widget {
    background-color: var(--color-surface-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    
    &:hover {
      box-shadow: var(--shadow-md);
    }
  }
}

// Journey Builder theme integration
.journey-builder {
  background-color: var(--color-bg-primary);
  
  .journey-canvas {
    background-color: var(--color-surface-primary);
    border: 1px solid var(--color-border-primary);
    
    // Update existing grid pattern to use theme colors
    &.canvas-grid {
      background-image: radial-gradient(
        circle, 
        var(--color-border-secondary) 1px, 
        transparent 1px
      );
    }
  }
  
  .journey-step {
    background-color: var(--color-surface-primary);
    border: 2px solid var(--color-border-primary);
    border-radius: var(--radius-xl);
    color: var(--color-text-primary);
    box-shadow: var(--shadow-sm);
    transition: var(--transition-base);
    
    &:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }
    
    &.selected {
      border-color: var(--color-interactive-primary);
      box-shadow: var(--shadow-focus);
    }
    
    &.dragging {
      box-shadow: var(--shadow-lg);
      opacity: 0.8;
    }
    
    // Journey stage specific colors (maintaining existing functionality)
    &.awareness {
      border-color: var(--journey-awareness-300);
      background: linear-gradient(135deg, var(--journey-awareness-50) 0%, var(--journey-awareness-100) 100%);
    }
    
    &.consideration {
      border-color: var(--journey-consideration-300);
      background: linear-gradient(135deg, var(--journey-consideration-50) 0%, var(--journey-consideration-100) 100%);
    }
    
    &.conversion {
      border-color: var(--journey-conversion-300);
      background: linear-gradient(135deg, var(--journey-conversion-50) 0%, var(--journey-conversion-100) 100%);
    }
    
    &.retention {
      border-color: var(--journey-retention-300);
      background: linear-gradient(135deg, var(--journey-retention-50) 0%, var(--journey-retention-100) 100%);
    }
  }
  
  .journey-toolbar {
    background-color: var(--color-surface-primary);
    border-bottom: 1px solid var(--color-border-primary);
    
    .toolbar-button {
      @extend .btn;
      @extend .btn-ghost;
    }
  }
  
  .journey-properties {
    background-color: var(--color-surface-secondary);
    border-left: 1px solid var(--color-border-primary);
    
    .property-group {
      border-bottom: 1px solid var(--color-border-primary);
      
      h3 {
        color: var(--color-text-primary);
        background-color: var(--color-surface-tertiary);
      }
    }
  }
}

// Content Editor theme integration
.content-editor {
  background-color: var(--color-bg-primary);
  
  .editor-toolbar {
    background-color: var(--color-surface-primary);
    border-bottom: 1px solid var(--color-border-primary);
    
    .toolbar-group {
      border-right: 1px solid var(--color-border-primary);
      
      .toolbar-button {
        @extend .btn;
        @extend .btn-ghost;
        @extend .btn-sm;
        
        &.active {
          background-color: var(--color-interactive-primary);
          color: white;
        }
      }
    }
  }
  
  .editor-content {
    background-color: var(--color-surface-primary);
    color: var(--color-text-primary);
    
    // Ensure proper contrast for content
    h1, h2, h3, h4, h5, h6 {
      color: var(--color-text-primary);
    }
    
    p {
      color: var(--color-text-tertiary);
    }
    
    blockquote {
      border-left-color: var(--color-border-interactive);
      background-color: var(--color-surface-secondary);
      color: var(--color-text-secondary);
    }
    
    code {
      background-color: var(--color-surface-tertiary);
      color: var(--color-text-brand);
      border: 1px solid var(--color-border-secondary);
    }
    
    pre {
      background-color: var(--color-surface-tertiary);
      border: 1px solid var(--color-border-secondary);
      color: var(--color-text-secondary);
    }
  }
  
  .editor-sidebar {
    background-color: var(--color-surface-secondary);
    border-left: 1px solid var(--color-border-primary);
  }
}

// Campaign Management theme integration
.campaign-management {
  background-color: var(--color-bg-primary);
  
  .campaign-header {
    background-color: var(--color-surface-primary);
    border-bottom: 1px solid var(--color-border-primary);
    
    .campaign-title {
      color: var(--color-text-primary);
    }
    
    .campaign-status {
      &.active {
        background-color: var(--color-status-success-bg);
        color: var(--color-status-success);
        border: 1px solid var(--color-status-success-border);
      }
      
      &.draft {
        background-color: var(--color-status-warning-bg);
        color: var(--color-status-warning);
        border: 1px solid var(--color-status-warning-border);
      }
      
      &.paused {
        background-color: var(--color-status-info-bg);
        color: var(--color-status-info);
        border: 1px solid var(--color-status-info-border);
      }
    }
  }
  
  .campaign-list {
    .campaign-item {
      background-color: var(--color-surface-primary);
      border: 1px solid var(--color-border-primary);
      border-radius: var(--radius-lg);
      transition: var(--transition-base);
      
      &:hover {
        box-shadow: var(--shadow-md);
        border-color: var(--color-border-secondary);
      }
      
      .campaign-name {
        color: var(--color-text-primary);
      }
      
      .campaign-description {
        color: var(--color-text-tertiary);
      }
      
      .campaign-metrics {
        .metric-value {
          color: var(--color-text-primary);
          font-weight: var(--weight-semibold);
        }
        
        .metric-label {
          color: var(--color-text-muted);
        }
      }
    }
  }
}

// Analytics Dashboard theme integration
.analytics-dashboard {
  background-color: var(--color-bg-primary);
  
  .analytics-header {
    background-color: var(--color-surface-primary);
    border-bottom: 1px solid var(--color-border-primary);
    
    .date-range-picker {
      @extend .input;
      
      .date-input {
        @extend .input;
        @extend .input-sm;
      }
    }
  }
  
  .analytics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-6);
    
    .analytics-card {
      @extend .card;
      
      .chart-container {
        background-color: var(--color-surface-primary);
        
        // Ensure chart colors work with theme
        .chart-primary {
          color: var(--color-interactive-primary);
        }
        
        .chart-secondary {
          color: var(--brand-secondary-500);
        }
        
        .chart-accent {
          color: var(--brand-accent-500);
        }
      }
      
      .metric-summary {
        .metric-number {
          color: var(--color-text-primary);
          font-weight: var(--weight-bold);
        }
        
        .metric-change {
          &.positive {
            color: var(--color-status-success);
          }
          
          &.negative {
            color: var(--color-status-error);
          }
          
          &.neutral {
            color: var(--color-text-muted);
          }
        }
      }
    }
  }
}

// Messaging Framework theme integration
.messaging-framework {
  background-color: var(--color-bg-primary);
  
  .framework-canvas {
    background-color: var(--color-surface-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-lg);
  }
  
  .message-card {
    background-color: var(--color-surface-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    transition: var(--transition-base);
    
    &:hover {
      box-shadow: var(--shadow-md);
    }
    
    .message-header {
      background-color: var(--color-surface-secondary);
      border-bottom: 1px solid var(--color-border-primary);
      
      .message-title {
        color: var(--color-text-primary);
      }
    }
    
    .message-content {
      color: var(--color-text-tertiary);
    }
    
    .message-actions {
      border-top: 1px solid var(--color-border-primary);
      background-color: var(--color-surface-secondary);
    }
  }
  
  .framework-sidebar {
    background-color: var(--color-surface-secondary);
    border-left: 1px solid var(--color-border-primary);
    
    .framework-templates {
      .template-item {
        border: 1px solid var(--color-border-primary);
        border-radius: var(--radius-md);
        background-color: var(--color-surface-primary);
        transition: var(--transition-colors);
        
        &:hover {
          background-color: var(--color-surface-tertiary);
          border-color: var(--color-border-secondary);
        }
      }
    }
  }
}

// =============================================================================
// FORM COMPONENTS INTEGRATION
// =============================================================================

// Update existing form styles to use theme system
.form-field {
  margin-bottom: var(--space-4);
  
  .form-label {
    color: var(--color-text-secondary);
    font-weight: var(--weight-medium);
    margin-bottom: var(--space-2);
    display: block;
  }
  
  .form-input {
    @extend .input;
  }
  
  .form-textarea {
    @extend .textarea;
  }
  
  .form-select {
    @extend .select;
  }
  
  .form-help {
    color: var(--color-text-muted);
    font-size: var(--type-sm);
    margin-top: var(--space-1);
  }
  
  .form-error {
    @extend .error-message;
  }
  
  .form-success {
    @extend .success-message;
  }
  
  &.form-field-error {
    .form-input,
    .form-textarea,
    .form-select {
      border-color: var(--color-status-error);
      
      &:focus {
        box-shadow: var(--shadow-focus-error);
      }
    }
  }
  
  &.form-field-success {
    .form-input,
    .form-textarea,
    .form-select {
      border-color: var(--color-status-success);
      
      &:focus {
        box-shadow: var(--shadow-focus-success);
      }
    }
  }
}

// =============================================================================
// TABLE COMPONENTS INTEGRATION
// =============================================================================

.table {
  width: 100%;
  border-collapse: collapse;
  background-color: var(--color-surface-primary);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  
  thead {
    background-color: var(--color-surface-secondary);
    
    th {
      padding: var(--space-3) var(--space-4);
      text-align: left;
      font-weight: var(--weight-semibold);
      color: var(--color-text-primary);
      border-bottom: 1px solid var(--color-border-primary);
      
      &:first-child {
        border-top-left-radius: var(--radius-lg);
      }
      
      &:last-child {
        border-top-right-radius: var(--radius-lg);
      }
    }
  }
  
  tbody {
    tr {
      border-bottom: 1px solid var(--color-border-primary);
      transition: var(--transition-colors);
      
      &:hover {
        background-color: var(--color-surface-secondary);
      }
      
      &:last-child {
        border-bottom: none;
      }
    }
    
    td {
      padding: var(--space-3) var(--space-4);
      color: var(--color-text-tertiary);
      
      &.table-actions {
        text-align: right;
        
        .btn {
          margin-left: var(--space-2);
        }
      }
    }
  }
  
  &.table-striped {
    tbody tr:nth-child(even) {
      background-color: var(--color-surface-secondary);
    }
  }
  
  &.table-bordered {
    border: 1px solid var(--color-border-primary);
    
    th,
    td {
      border-right: 1px solid var(--color-border-primary);
      
      &:last-child {
        border-right: none;
      }
    }
  }
}

// =============================================================================
// NAVIGATION COMPONENTS INTEGRATION
// =============================================================================

.navbar {
  background-color: var(--color-surface-primary);
  border-bottom: 1px solid var(--color-border-primary);
  box-shadow: var(--shadow-sm);
  
  .navbar-brand {
    color: var(--color-text-primary);
    font-weight: var(--weight-bold);
    text-decoration: none;
    
    &:hover {
      color: var(--color-interactive-primary);
    }
  }
  
  .navbar-nav {
    .nav-link {
      color: var(--color-text-secondary);
      text-decoration: none;
      padding: var(--space-2) var(--space-3);
      border-radius: var(--radius-md);
      transition: var(--transition-colors);
      
      &:hover {
        color: var(--color-text-primary);
        background-color: var(--color-surface-secondary);
      }
      
      &.active {
        color: var(--color-interactive-primary);
        background-color: var(--brand-primary-50);
      }
    }
  }
  
  .navbar-toggle {
    @extend .btn;
    @extend .btn-ghost;
    @extend .btn-sm;
  }
}

.breadcrumb {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-4);
  
  .breadcrumb-item {
    color: var(--color-text-muted);
    
    a {
      color: var(--color-interactive-primary);
      text-decoration: none;
      
      &:hover {
        text-decoration: underline;
      }
    }
    
    &:not(:last-child)::after {
      content: "/";
      margin-left: var(--space-2);
      color: var(--color-text-muted);
    }
    
    &:last-child {
      color: var(--color-text-primary);
      font-weight: var(--weight-medium);
    }
  }
}

// =============================================================================
// SIDEBAR COMPONENTS INTEGRATION
// =============================================================================

.sidebar {
  background-color: var(--color-surface-primary);
  border-right: 1px solid var(--color-border-primary);
  height: 100vh;
  width: var(--sidebar-width);
  transition: width var(--duration-300) var(--ease-out);
  
  &.sidebar-collapsed {
    width: var(--sidebar-width-collapsed);
  }
  
  .sidebar-header {
    padding: var(--space-4);
    border-bottom: 1px solid var(--color-border-primary);
    
    .sidebar-brand {
      color: var(--color-text-primary);
      font-weight: var(--weight-bold);
    }
  }
  
  .sidebar-nav {
    padding: var(--space-2);
    
    .nav-group {
      margin-bottom: var(--space-4);
      
      .nav-group-title {
        color: var(--color-text-muted);
        font-size: var(--type-xs);
        font-weight: var(--weight-semibold);
        text-transform: uppercase;
        letter-spacing: var(--tracking-wide);
        margin-bottom: var(--space-2);
        padding: 0 var(--space-3);
      }
    }
    
    .nav-item {
      margin-bottom: var(--space-1);
      
      .nav-link {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        padding: var(--space-3);
        color: var(--color-text-secondary);
        text-decoration: none;
        border-radius: var(--radius-md);
        transition: var(--transition-colors);
        
        .nav-icon {
          flex-shrink: 0;
          width: 1.25rem;
          height: 1.25rem;
        }
        
        .nav-text {
          flex: 1;
        }
        
        .nav-badge {
          @extend .badge;
          @extend .badge-sm;
        }
        
        &:hover {
          background-color: var(--color-surface-secondary);
          color: var(--color-text-primary);
        }
        
        &.active {
          background-color: var(--color-interactive-primary);
          color: white;
        }
      }
    }
  }
  
  .sidebar-footer {
    padding: var(--space-4);
    border-top: 1px solid var(--color-border-primary);
    margin-top: auto;
  }
}

// =============================================================================
// RESPONSIVE ADJUSTMENTS
// =============================================================================

@media (max-width: 768px) {
  .dashboard-sidebar,
  .sidebar {
    position: fixed;
    left: -100%;
    z-index: var(--z-index-overlay);
    transition: left var(--duration-300) var(--ease-out);
    
    &.sidebar-open {
      left: 0;
    }
  }
  
  .journey-builder {
    .journey-properties {
      position: fixed;
      right: -100%;
      top: 0;
      bottom: 0;
      width: 280px;
      z-index: var(--z-index-overlay);
      transition: right var(--duration-300) var(--ease-out);
      
      &.properties-open {
        right: 0;
      }
    }
  }
  
  .content-editor {
    .editor-sidebar {
      position: fixed;
      right: -100%;
      top: 0;
      bottom: 0;
      width: 280px;
      z-index: var(--z-index-overlay);
      transition: right var(--duration-300) var(--ease-out);
      
      &.sidebar-open {
        right: 0;
      }
    }
  }
  
  .analytics-grid {
    grid-template-columns: 1fr;
  }
  
  .table {
    font-size: var(--type-sm);
    
    th,
    td {
      padding: var(--space-2) var(--space-3);
    }
  }
}

// =============================================================================
// DARK THEME SPECIFIC INTEGRATIONS
// =============================================================================

[data-theme="dark"] {
  // Enhanced contrast for existing components
  .journey-step {
    &.awareness {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.2) 100%);
      border-color: rgba(59, 130, 246, 0.5);
    }
    
    &.consideration {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.2) 100%);
      border-color: rgba(16, 185, 129, 0.5);
    }
    
    &.conversion {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.2) 100%);
      border-color: rgba(245, 158, 11, 0.5);
    }
    
    &.retention {
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(139, 92, 246, 0.2) 100%);
      border-color: rgba(139, 92, 246, 0.5);
    }
  }
  
  // Ensure proper contrast for charts and graphs
  .analytics-card {
    .chart-container {
      // Chart colors optimized for dark backgrounds
      .chart-primary {
        color: #60a5fa; // Lighter blue for dark theme
      }
      
      .chart-secondary {
        color: #a78bfa; // Lighter purple for dark theme
      }
      
      .chart-accent {
        color: #34d399; // Lighter green for dark theme
      }
    }
  }
  
  // Enhanced form contrast
  .form-input,
  .form-textarea,
  .form-select {
    background-color: var(--color-neutral-800);
    border-color: var(--color-neutral-600);
    color: var(--color-text-primary);
    
    &::placeholder {
      color: var(--color-neutral-400);
    }
  }
}