<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
    .header { background-color: #f8f9fa; padding: 20px; border-bottom: 3px solid #dc3545; }
    .content { padding: 20px; }
    .user-info { background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0; }
    .alert { padding: 12px; border-radius: 4px; margin: 10px 0; }
    .alert-danger { background-color: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
    .alert-warning { background-color: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
    .footer { background-color: #f8f9fa; padding: 15px; border-top: 1px solid #dee2e6; font-size: 12px; color: #6c757d; }
    .actions { background-color: #e9ecef; padding: 15px; border-radius: 5px; margin: 15px 0; }
    .details { background-color: #fff; border: 1px solid #dee2e6; padding: 15px; border-radius: 5px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>üö® User Account Alert</h1>
    <p>
      <strong>Alert Type:</strong> <%= @alert_type.humanize %><br>
      <strong>Time:</strong> <%= @alert_time.strftime('%B %d, %Y at %I:%M %p') %>
    </p>
  </div>

  <div class="content">
    <% if @alert_type == 'locked' %>
      <div class="alert alert-warning">
        <strong>‚ö†Ô∏è User Account Locked</strong><br>
        A user account has been automatically locked due to security concerns.
      </div>
    <% elsif @alert_type == 'suspended' %>
      <div class="alert alert-danger">
        <strong>üö´ User Account Suspended</strong><br>
        A user account has been suspended by an administrator.
      </div>
    <% elsif @alert_type == 'multiple_failed_logins' %>
      <div class="alert alert-warning">
        <strong>üîê Multiple Failed Login Attempts</strong><br>
        A user account has exceeded the maximum number of failed login attempts.
      </div>
    <% end %>

    <div class="user-info">
      <h3>User Information</h3>
      <p>
        <strong>Email:</strong> <%= @user.email_address %><br>
        <strong>Name:</strong> <%= @user.display_name %><br>
        <strong>Role:</strong> <%= @user.role.humanize %><br>
        <strong>Account Created:</strong> <%= @user.created_at.strftime('%B %d, %Y') %><br>
        <strong>Company:</strong> <%= @user.company.presence || 'Not specified' %><br>
        <strong>Job Title:</strong> <%= @user.job_title.presence || 'Not specified' %>
      </p>
    </div>

    <% if @details.present? %>
      <div class="details">
        <h3>Additional Details</h3>
        <% @details.each do |key, value| %>
          <p><strong><%= key.to_s.humanize %>:</strong> <%= value %></p>
        <% end %>
      </div>
    <% end %>

    <div class="actions">
      <h3>Recommended Actions</h3>
      <% case @alert_type %>
      <% when 'locked' %>
        <ul>
          <li>Review recent login attempts for suspicious activity</li>
          <li>Contact the user to verify legitimate access attempts</li>
          <li>Unlock the account if the activity is verified as legitimate</li>
          <li>Consider additional security measures if suspicious activity is confirmed</li>
        </ul>
      <% when 'suspended' %>
        <ul>
          <li>Review the suspension reason and supporting documentation</li>
          <li>Verify the suspension was appropriate and properly documented</li>
          <li>Monitor for any attempts to create new accounts</li>
          <li>Follow up with the user if necessary</li>
        </ul>
      <% when 'multiple_failed_logins' %>
        <ul>
          <li>Investigate the source of failed login attempts</li>
          <li>Check for patterns indicating automated attacks</li>
          <li>Consider implementing additional security measures</li>
          <li>Contact the user to verify they are having login issues</li>
        </ul>
      <% end %>
    </div>

    <p>
      <strong>Admin Access:</strong> 
      <a href="<%= rails_admin_url_for(@user) %>">View User in Admin Panel</a>
    </p>

    <p>
      <strong>Alert generated for:</strong> <%= @admin_user.display_name %> (<%= @admin_user.email_address %>)<br>
      <strong>Timestamp:</strong> <%= @alert_time.strftime('%Y-%m-%d %H:%M:%S %Z') %>
    </p>
  </div>

  <div class="footer">
    <p>
      This is an automated security alert. Please review and take appropriate action if necessary.
      For questions or concerns, please contact the system administrator.
    </p>
    <p>Generated by Marketer Gen Security System</p>
  </div>
</body>
</html>