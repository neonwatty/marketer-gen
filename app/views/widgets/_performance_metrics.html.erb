<!-- Performance Metrics Cards -->
<div class="<%= dashboard_widget_classes(size: 'medium', collapsible: true) %>" 
     data-controller="widget collapsible" 
     data-widget-type-value="performance-metrics">
  
  <!-- Widget Header -->
  <div class="widget-header flex items-center justify-between p-6 border-b border-gray-100">
    <div class="flex items-center">
      <div class="flex-shrink-0">
        <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center">
          <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
          </svg>
        </div>
      </div>
      <div class="ml-3">
        <h3 class="text-lg font-semibold text-primary">Performance Metrics</h3>
        <p class="text-sm text-tertiary">Real-time campaign performance indicators</p>
      </div>
    </div>
    
    <!-- Widget Controls -->
    <div class="flex items-center space-x-2">
      <!-- Metric Type Selector -->
      <select class="text-sm border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
              data-action="change->widget#updateMetricType">
        <option value="engagement">Engagement</option>
        <option value="conversion" selected>Conversion</option>
        <option value="revenue">Revenue</option>
      </select>
      
      <!-- Collapse Toggle -->
      <button class="p-1.5 text-muted hover:text-primary hover:bg-gray-100 rounded-md transition-colors"
              data-action="click->collapsible#toggle"
              data-collapsible-target="trigger"
              aria-label="Collapse widget">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>
        </svg>
      </button>
    </div>
  </div>
  
  <!-- Widget Content -->
  <div class="widget-content" data-collapsible-target="content">
    <div class="p-6">
      
      <!-- Primary Metrics Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        
        <!-- Click-Through Rate -->
        <div class="metric-card">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center">
              <div class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center">
                <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
                </svg>
              </div>
              <div class="ml-3">
                <h4 class="text-sm font-semibold text-primary">Click-Through Rate</h4>
                <p class="text-xs text-muted">Average across all campaigns</p>
              </div>
            </div>
            <button class="p-1 text-muted hover:text-primary rounded-md transition-colors"
                    data-action="click->widget#showDetails"
                    data-metric="ctr"
                    aria-label="View CTR details">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </button>
          </div>
          
          <div class="flex items-end justify-between">
            <div>
              <p class="text-3xl font-bold text-primary mb-1" data-widget-target="ctrValue">
                2.85%
              </p>
              <div class="flex items-center">
                <%= trend_indicator(2.85, 2.41) %>
                <span class="ml-2 text-xs text-muted">vs last period</span>
              </div>
            </div>
            
            <!-- Mini Chart -->
            <div class="w-20 h-12">
              <div class="flex items-end h-full space-x-1">
                <div class="bg-blue-200 rounded-sm" style="height: 60%; width: 12%;"></div>
                <div class="bg-blue-300 rounded-sm" style="height: 75%; width: 12%;"></div>
                <div class="bg-blue-400 rounded-sm" style="height: 45%; width: 12%;"></div>
                <div class="bg-blue-500 rounded-sm" style="height: 85%; width: 12%;"></div>
                <div class="bg-blue-600 rounded-sm" style="height: 100%; width: 12%;"></div>
                <div class="bg-blue-700 rounded-sm" style="height: 90%; width: 12%;"></div>
                <div class="bg-blue-600 rounded-sm" style="height: 95%; width: 12%;"></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Conversion Rate -->
        <div class="metric-card">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center">
              <div class="w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center">
                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div class="ml-3">
                <h4 class="text-sm font-semibold text-primary">Conversion Rate</h4>
                <p class="text-xs text-muted">Visitors to customers</p>
              </div>
            </div>
            <button class="p-1 text-muted hover:text-primary rounded-md transition-colors"
                    data-action="click->widget#showDetails"
                    data-metric="conversion"
                    aria-label="View conversion details">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </button>
          </div>
          
          <div class="flex items-end justify-between">
            <div>
              <p class="text-3xl font-bold text-primary mb-1" data-widget-target="conversionValue">
                3.42%
              </p>
              <div class="flex items-center">
                <%= trend_indicator(3.42, 3.18) %>
                <span class="ml-2 text-xs text-muted">vs last period</span>
              </div>
            </div>
            
            <!-- Mini Chart -->
            <div class="w-20 h-12">
              <div class="flex items-end h-full space-x-1">
                <div class="bg-green-200 rounded-sm" style="height: 50%; width: 12%;"></div>
                <div class="bg-green-300 rounded-sm" style="height: 65%; width: 12%;"></div>
                <div class="bg-green-400 rounded-sm" style="height: 80%; width: 12%;"></div>
                <div class="bg-green-500 rounded-sm" style="height: 70%; width: 12%;"></div>
                <div class="bg-green-600 rounded-sm" style="height: 90%; width: 12%;"></div>
                <div class="bg-green-700 rounded-sm" style="height: 85%; width: 12%;"></div>
                <div class="bg-green-600 rounded-sm" style="height: 100%; width: 12%;"></div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
      
      <!-- Secondary Metrics -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        
        <!-- Cost Per Click -->
        <div class="text-center p-4 bg-orange-50 rounded-lg">
          <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-2">
            <svg class="w-4 h-4 text-orange-600" fill="currentColor" viewBox="0 0 20 20">
              <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"></path>
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-lg font-bold text-orange-900">$1.23</p>
          <p class="text-xs text-orange-700">Cost Per Click</p>
          <p class="text-xs text-success font-medium mt-1">↓ $0.15</p>
        </div>
        
        <!-- Return on Ad Spend -->
        <div class="text-center p-4 bg-purple-50 rounded-lg">
          <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-2">
            <svg class="w-4 h-4 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-lg font-bold text-purple-900">4.7x</p>
          <p class="text-xs text-purple-700">ROAS</p>
          <p class="text-xs text-success font-medium mt-1">↗ 0.3x</p>
        </div>
        
        <!-- Customer Lifetime Value -->
        <div class="text-center p-4 bg-teal-50 rounded-lg">
          <div class="w-8 h-8 bg-teal-100 rounded-full flex items-center justify-center mx-auto mb-2">
            <svg class="w-4 h-4 text-teal-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-lg font-bold text-teal-900">$287</p>
          <p class="text-xs text-teal-700">Avg. CLV</p>
          <p class="text-xs text-success font-medium mt-1">↗ $23</p>
        </div>
        
        <!-- Bounce Rate -->
        <div class="text-center p-4 bg-red-50 rounded-lg">
          <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2">
            <svg class="w-4 h-4 text-red-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <p class="text-lg font-bold text-red-900">24.5%</p>
          <p class="text-xs text-red-700">Bounce Rate</p>
          <p class="text-xs text-success font-medium mt-1">↓ 2.1%</p>
        </div>
        
      </div>
      
      <!-- Performance Benchmarks -->
      <div class="bg-gray-50 rounded-xl p-4">
        <div class="flex items-center justify-between mb-4">
          <h4 class="text-sm font-semibold text-primary">Industry Benchmarks</h4>
          <span class="text-xs text-muted bg-white px-2 py-1 rounded-full">Updated daily</span>
        </div>
        
        <div class="space-y-3">
          <!-- CTR Benchmark -->
          <div>
            <div class="flex items-center justify-between mb-1">
              <span class="text-sm text-secondary">Click-Through Rate</span>
              <div class="flex items-center space-x-2">
                <span class="text-sm font-medium text-primary">2.85%</span>
                <span class="text-xs text-muted">vs 2.1% avg</span>
              </div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-green-500 h-2 rounded-full relative" style="width: 85%">
                <div class="absolute right-0 top-0 w-1 h-2 bg-blue-600 rounded-r-full"></div>
              </div>
            </div>
          </div>
          
          <!-- Conversion Benchmark -->
          <div>
            <div class="flex items-center justify-between mb-1">
              <span class="text-sm text-secondary">Conversion Rate</span>
              <div class="flex items-center space-x-2">
                <span class="text-sm font-medium text-primary">3.42%</span>
                <span class="text-xs text-muted">vs 2.8% avg</span>
              </div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-green-500 h-2 rounded-full relative" style="width: 75%">
                <div class="absolute right-0 top-0 w-1 h-2 bg-blue-600 rounded-r-full"></div>
              </div>
            </div>
          </div>
          
          <!-- CPC Benchmark -->
          <div>
            <div class="flex items-center justify-between mb-1">
              <span class="text-sm text-secondary">Cost Per Click</span>
              <div class="flex items-center space-x-2">
                <span class="text-sm font-medium text-primary">$1.23</span>
                <span class="text-xs text-muted">vs $1.47 avg</span>
              </div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-green-500 h-2 rounded-full relative" style="width: 60%">
                <div class="absolute right-0 top-0 w-1 h-2 bg-blue-600 rounded-r-full"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>