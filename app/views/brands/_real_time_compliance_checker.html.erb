<%# Real-time Brand Compliance Checker Modal Content %>
<div class="space-y-6" data-controller="real-time-compliance" data-brand-id="<%= brand.id %>">
  <!-- Header with Settings -->
  <div class="flex items-center justify-between">
    <div>
      <h4 class="text-lg font-semibold text-gray-900">Real-time Compliance Checker</h4>
      <p class="text-sm text-gray-600 mt-1">Get instant feedback on brand compliance as you type</p>
    </div>
    
    <!-- Settings Toggle -->
    <div class="flex items-center space-x-2">
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" 
               data-real-time-compliance-target="realTimeToggle"
               data-action="change->real-time-compliance#toggleRealTime"
               class="sr-only peer" 
               checked>
        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
      </label>
      <span class="text-sm text-gray-700">Real-time</span>
    </div>
  </div>
  
  <!-- Content Input with Live Validation -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Content Input (Left Column) -->
    <div class="lg:col-span-2 space-y-4">
      <!-- Content Type and Channel -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Content Type</label>
          <select data-real-time-compliance-target="contentType" 
                  data-action="change->real-time-compliance#updateContext"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm">
            <option value="general">General Content</option>
            <option value="email_subject">Email Subject Line</option>
            <option value="email_body">Email Body</option>
            <option value="social_post">Social Media Post</option>
            <option value="ad_headline">Ad Headline</option>
            <option value="ad_copy">Ad Copy</option>
            <option value="website_hero">Website Hero Text</option>
            <option value="blog_title">Blog Title</option>
            <option value="blog_content">Blog Content</option>
            <option value="press_release">Press Release</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Target Audience</label>
          <select data-real-time-compliance-target="targetAudience" 
                  data-action="change->real-time-compliance#updateContext"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm">
            <option value="general">General Audience</option>
            <option value="customers">Existing Customers</option>
            <option value="prospects">Prospects</option>
            <option value="partners">Business Partners</option>
            <option value="media">Media/Press</option>
            <option value="internal">Internal Team</option>
          </select>
        </div>
      </div>
      
      <!-- Content Input Area -->
      <div class="relative">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Content
          <span class="text-xs text-gray-500 ml-2">(Type to see real-time feedback)</span>
        </label>
        
        <div class="relative">
          <textarea data-real-time-compliance-target="contentInput"
                    data-action="input->real-time-compliance#validateRealTime keyup->real-time-compliance#updateStats"
                    rows="12"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none font-mono text-sm pr-20"
                    placeholder="Start typing your content here...

Example:
ðŸŽ¯ Revolutionize your marketing strategy with our AI-powered platform! 
âœ¨ Drive unprecedented growth and maximize ROI
ðŸ’¡ Join thousands of successful businesses already using our solutions"></textarea>
          
          <!-- Live Status Indicator -->
          <div class="absolute top-3 right-3">
            <div data-real-time-compliance-target="statusIndicator" 
                 class="w-3 h-3 rounded-full bg-gray-300 transition-colors"></div>
          </div>
        </div>
        
        <!-- Content Stats -->
        <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
          <div class="space-x-4">
            <span>
              <span data-real-time-compliance-target="charCount">0</span> characters
            </span>
            <span>
              <span data-real-time-compliance-target="wordCount">0</span> words
            </span>
            <span>
              <span data-real-time-compliance-target="sentenceCount">0</span> sentences
            </span>
          </div>
          <div>
            <span data-real-time-compliance-target="readingTime">0 min read</span>
          </div>
        </div>
      </div>
      
      <!-- Quick Action Buttons -->
      <div class="flex flex-wrap gap-2">
        <button data-action="click->real-time-compliance#optimizeContent"
                class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors">
          âœ¨ AI Optimize
        </button>
        
        <button data-action="click->real-time-compliance#generateVariations"
                class="px-3 py-1.5 border border-gray-300 text-gray-700 text-sm rounded-lg hover:bg-gray-50 transition-colors">
          ðŸ”„ Generate Variations
        </button>
        
        <button data-action="click->real-time-compliance#loadTemplate"
                class="px-3 py-1.5 border border-gray-300 text-gray-700 text-sm rounded-lg hover:bg-gray-50 transition-colors">
          ðŸ“‹ Load Template
        </button>
        
        <button data-action="click->real-time-compliance#clearContent"
                class="px-3 py-1.5 text-gray-500 text-sm rounded-lg hover:bg-gray-100 transition-colors">
          ðŸ—‘ Clear
        </button>
      </div>
    </div>
    
    <!-- Live Feedback Panel (Right Column) -->
    <div class="space-y-4">
      <!-- Compliance Score Card -->
      <div class="bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl p-6 border border-indigo-100">
        <div class="text-center">
          <div class="relative inline-flex items-center justify-center w-20 h-20 mb-3">
            <svg class="w-full h-full transform -rotate-90" viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="35" fill="transparent" stroke="#e0e7ff" stroke-width="6"/>
              <circle data-real-time-compliance-target="scoreCircle"
                      cx="50" cy="50" r="35" fill="transparent" stroke="#3b82f6" stroke-width="6"
                      stroke-dasharray="0, 219.8" stroke-linecap="round" 
                      class="transition-all duration-500"/>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span data-real-time-compliance-target="scoreValue" 
                    class="text-lg font-bold text-gray-800">--</span>
            </div>
          </div>
          
          <h5 class="text-sm font-semibold text-gray-900 mb-1">Compliance Score</h5>
          <p data-real-time-compliance-target="scoreLabel" 
             class="text-xs text-gray-600">Enter content for analysis</p>
        </div>
        
        <!-- Score Breakdown -->
        <div data-real-time-compliance-target="scoreBreakdown" class="hidden mt-4 space-y-2">
          <div class="flex justify-between items-center text-xs">
            <span class="text-gray-600">Voice & Tone</span>
            <div class="flex items-center space-x-2">
              <div class="w-12 bg-gray-200 rounded-full h-1.5">
                <div data-score-bar="voice" class="bg-blue-500 h-1.5 rounded-full transition-all duration-300" style="width: 0%"></div>
              </div>
              <span data-score-text="voice" class="font-medium text-gray-800 w-8 text-right">--</span>
            </div>
          </div>
          
          <div class="flex justify-between items-center text-xs">
            <span class="text-gray-600">Messaging</span>
            <div class="flex items-center space-x-2">
              <div class="w-12 bg-gray-200 rounded-full h-1.5">
                <div data-score-bar="messaging" class="bg-green-500 h-1.5 rounded-full transition-all duration-300" style="width: 0%"></div>
              </div>
              <span data-score-text="messaging" class="font-medium text-gray-800 w-8 text-right">--</span>
            </div>
          </div>
          
          <div class="flex justify-between items-center text-xs">
            <span class="text-gray-600">Compliance</span>
            <div class="flex items-center space-x-2">
              <div class="w-12 bg-gray-200 rounded-full h-1.5">
                <div data-score-bar="compliance" class="bg-orange-500 h-1.5 rounded-full transition-all duration-300" style="width: 0%"></div>
              </div>
              <span data-score-text="compliance" class="font-medium text-gray-800 w-8 text-right">--</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Live Issues & Suggestions -->
      <div class="bg-white rounded-xl border border-gray-200 p-4">
        <h5 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
          <svg class="w-4 h-4 mr-2 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
          </svg>
          Issues & Suggestions
        </h5>
        
        <div data-real-time-compliance-target="liveIssues" class="space-y-2 max-h-64 overflow-y-auto">
          <div class="text-center py-4 text-gray-500">
            <svg class="mx-auto h-6 w-6 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p class="text-xs">No issues detected</p>
          </div>
        </div>
      </div>
      
      <!-- Brand Rules Quick Reference -->
      <div class="bg-white rounded-xl border border-gray-200 p-4">
        <h5 class="text-sm font-semibold text-gray-900 mb-3 flex items-center">
          <svg class="w-4 h-4 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          Brand Rules
        </h5>
        
        <div class="space-y-3 text-xs">
          <!-- Voice & Tone -->
          <div>
            <h6 class="font-medium text-gray-700 mb-1">Voice & Tone</h6>
            <% if brand.brand_analyses.completed.any? %>
              <% analysis = brand.brand_analyses.completed.first %>
              <% if analysis.voice_attributes.present? %>
                <div class="flex flex-wrap gap-1">
                  <% analysis.voice_attributes.each do |attr, value| %>
                    <span class="inline-block px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">
                      <%= "#{attr.humanize}: #{value}" %>
                    </span>
                  <% end %>
                </div>
              <% else %>
                <p class="text-gray-500">No voice attributes defined</p>
              <% end %>
            <% else %>
              <p class="text-gray-500">Complete brand analysis first</p>
            <% end %>
          </div>
          
          <!-- Approved Phrases -->
          <% if brand.messaging_frameworks.active.any? %>
            <% framework = brand.messaging_frameworks.active.first %>
            <% if framework.approved_phrases&.any? %>
              <div>
                <h6 class="font-medium text-gray-700 mb-1">Use These Phrases</h6>
                <div class="space-y-1">
                  <% framework.approved_phrases.first(3).each do |phrase| %>
                    <div class="text-green-700 bg-green-50 px-2 py-1 rounded">
                      âœ“ <%= phrase %>
                    </div>
                  <% end %>
                  <% if framework.approved_phrases.count > 3 %>
                    <p class="text-gray-500">+<%= framework.approved_phrases.count - 3 %> more</p>
                  <% end %>
                </div>
              </div>
            <% end %>
            
            <!-- Banned Words -->
            <% if framework.banned_words&.any? %>
              <div>
                <h6 class="font-medium text-gray-700 mb-1">Avoid These Words</h6>
                <div class="space-y-1">
                  <% framework.banned_words.first(3).each do |word| %>
                    <div class="text-red-700 bg-red-50 px-2 py-1 rounded">
                      âœ— <%= word %>
                    </div>
                  <% end %>
                  <% if framework.banned_words.count > 3 %>
                    <p class="text-gray-500">+<%= framework.banned_words.count - 3 %> more</p>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Action Buttons -->
  <div class="flex justify-between items-center pt-4 border-t border-gray-200">
    <div class="flex items-center space-x-4 text-sm text-gray-600">
      <div class="flex items-center space-x-1">
        <div data-real-time-compliance-target="connectionStatus" class="w-2 h-2 rounded-full bg-green-400"></div>
        <span>Connected</span>
      </div>
      
      <div>
        Last checked: <span data-real-time-compliance-target="lastChecked">--</span>
      </div>
    </div>
    
    <div class="flex space-x-3">
      <button data-action="click->real-time-compliance#saveTemplate"
              data-real-time-compliance-target="saveButton"
              class="px-4 py-2 border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors">
        Save as Template
      </button>
      
      <button data-action="click->real-time-compliance#exportAnalysis"
              class="px-4 py-2 border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors">
        Export Analysis
      </button>
      
      <button data-action="click->real-time-compliance#generateFinalReport"
              class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition-colors">
        Generate Report
      </button>
    </div>
  </div>
</div>

<!-- Processing Overlay -->
<div data-real-time-compliance-target="processingOverlay" 
     class="hidden absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center rounded-xl">
  <div class="text-center">
    <svg class="mx-auto h-8 w-8 text-indigo-600 animate-spin mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
    </svg>
    <p class="text-sm font-medium text-gray-900">Analyzing content...</p>
    <p class="text-xs text-gray-600 mt-1">This may take a few seconds</p>
  </div>
</div>