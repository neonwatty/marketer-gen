<tr class="hover:bg-gray-50 transition-colors" 
    data-controller="inline-edit" 
    data-inline-edit-url-value="<%= campaign_path(campaign) %>"
    data-campaign-id="<%= campaign.id %>"
    role="row">
  
  <!-- Select Checkbox -->
  <td class="w-12 px-6 py-4" data-column="select">
    <input type="checkbox" 
           class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" 
           data-action="change->bulk-actions#toggleSelect"
           data-bulk-actions-target="checkbox"
           data-campaign-id="<%= campaign.id %>"
           aria-label="Select campaign <%= campaign.name %>">
  </td>
  
  <!-- Campaign Name (with inline editing) -->
  <td class="px-6 py-4" data-column="name">
    <div class="flex items-center">
      <div class="flex-shrink-0">
        <!-- Campaign Type Icon -->
        <div class="w-8 h-8 rounded-lg flex items-center justify-center <%= campaign_type_bg_color(campaign.campaign_type) %>">
          <%= campaign_type_icon(campaign.campaign_type) %>
        </div>
      </div>
      <div class="ml-4 flex-1">
        <!-- Editable Name -->
        <div class="inline-edit-field" data-inline-edit-target="field" data-field="name">
          <div class="view-mode" data-inline-edit-target="display">
            <div class="text-sm font-medium text-gray-900 hover:text-blue-600 cursor-pointer" 
                 data-action="click->inline-edit#startEdit"
                 tabindex="0"
                 role="button"
                 aria-label="Edit campaign name: <%= campaign.name %>">
              <%= campaign.name %>
              <svg class="inline w-3 h-3 ml-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
              </svg>
            </div>
          </div>
          <div class="edit-mode hidden" data-inline-edit-target="editor">
            <div class="flex items-center space-x-2">
              <input type="text" 
                     class="flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                     data-inline-edit-target="input"
                     data-field="name"
                     value="<%= campaign.name %>"
                     aria-label="Edit campaign name">
              <button type="button" 
                      class="p-1 text-green-600 hover:text-green-700"
                      data-action="click->inline-edit#save"
                      aria-label="Save changes">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
              </button>
              <button type="button" 
                      class="p-1 text-gray-400 hover:text-gray-600"
                      data-action="click->inline-edit#cancel"
                      aria-label="Cancel editing">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Description -->
        <div class="text-sm text-gray-500 mt-1 truncate max-w-xs" title="<%= campaign.description %>">
          <%= campaign.description || 'No description' %>
        </div>
      </div>
    </div>
  </td>
  
  <!-- Status (with inline editing) -->
  <td class="px-6 py-4" data-column="status">
    <div class="inline-edit-field" data-inline-edit-target="field" data-field="status">
      <div class="view-mode" data-inline-edit-target="display">
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium cursor-pointer hover:opacity-80 <%= campaign_status_classes(campaign.status) %>"
              data-action="click->inline-edit#startEdit"
              tabindex="0"
              role="button"
              aria-label="Edit status: <%= campaign.status.humanize %>">
          <%= campaign_status_icon(campaign.status) %>
          <span class="ml-1"><%= campaign.status.humanize %></span>
          <svg class="inline w-3 h-3 ml-1 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
          </svg>
        </span>
      </div>
      <div class="edit-mode hidden" data-inline-edit-target="editor">
        <div class="flex items-center space-x-2">
          <select class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                  data-inline-edit-target="input"
                  data-field="status"
                  aria-label="Select campaign status">
            <% Campaign::STATUSES.each do |status| %>
              <option value="<%= status %>" <%= 'selected' if campaign.status == status %>>
                <%= status.humanize %>
              </option>
            <% end %>
          </select>
          <button type="button" 
                  class="p-1 text-green-600 hover:text-green-700"
                  data-action="click->inline-edit#save"
                  aria-label="Save status change">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          </button>
          <button type="button" 
                  class="p-1 text-gray-400 hover:text-gray-600"
                  data-action="click->inline-edit#cancel"
                  aria-label="Cancel editing">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </td>
  
  <!-- Campaign Type -->
  <td class="px-6 py-4" data-column="type">
    <div class="inline-edit-field" data-inline-edit-target="field" data-field="campaign_type">
      <div class="view-mode" data-inline-edit-target="display">
        <span class="text-sm text-gray-900 cursor-pointer hover:text-blue-600"
              data-action="click->inline-edit#startEdit"
              tabindex="0"
              role="button"
              aria-label="Edit campaign type: <%= campaign.campaign_type&.humanize || 'Not set' %>">
          <%= campaign.campaign_type&.humanize || 'Not set' %>
          <svg class="inline w-3 h-3 ml-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
          </svg>
        </span>
      </div>
      <div class="edit-mode hidden" data-inline-edit-target="editor">
        <div class="flex items-center space-x-2">
          <select class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                  data-inline-edit-target="input"
                  data-field="campaign_type"
                  aria-label="Select campaign type">
            <option value="">Select type...</option>
            <% Campaign::CAMPAIGN_TYPES.each do |type| %>
              <option value="<%= type %>" <%= 'selected' if campaign.campaign_type == type %>>
                <%= type.humanize %>
              </option>
            <% end %>
          </select>
          <button type="button" 
                  class="p-1 text-green-600 hover:text-green-700"
                  data-action="click->inline-edit#save"
                  aria-label="Save type change">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          </button>
          <button type="button" 
                  class="p-1 text-gray-400 hover:text-gray-600"
                  data-action="click->inline-edit#cancel"
                  aria-label="Cancel editing">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </td>
  
  <!-- Persona -->
  <td class="px-6 py-4" data-column="persona">
    <div class="flex items-center">
      <div class="flex-shrink-0 w-6 h-6">
        <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
          <span class="text-xs font-medium text-gray-600">
            <%= campaign.persona.name[0].upcase %>
          </span>
        </div>
      </div>
      <div class="ml-2">
        <div class="text-sm font-medium text-gray-900">
          <%= campaign.persona.name %>
        </div>
      </div>
    </div>
  </td>
  
  <!-- Created Date -->
  <td class="px-6 py-4 text-sm text-gray-500" data-column="created_at">
    <div class="flex flex-col">
      <span><%= campaign.created_at.strftime('%m/%d/%Y') %></span>
      <span class="text-xs text-gray-400"><%= time_ago_in_words(campaign.created_at) %> ago</span>
    </div>
  </td>
  
  <!-- Performance -->
  <td class="px-6 py-4" data-column="performance">
    <% if campaign.active? || campaign.completed? %>
      <% performance = campaign.performance_summary %>
      <div class="flex items-center">
        <div class="flex-1">
          <!-- Completion Rate -->
          <div class="flex items-center justify-between mb-1">
            <span class="text-xs text-gray-500">Completion</span>
            <span class="text-xs font-medium text-gray-900">
              <%= performance[:completion_rate] || 0 %>%
            </span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-1.5 mb-2">
            <div class="bg-blue-600 h-1.5 rounded-full" 
                 style="width: <%= [performance[:completion_rate] || 0, 100].min %>%"
                 aria-label="<%= performance[:completion_rate] || 0 %>% completion rate"></div>
          </div>
          
          <!-- Journey Count -->
          <div class="text-xs text-gray-500">
            <%= pluralize(campaign.journeys.count, 'journey') %>
          </div>
        </div>
      </div>
    <% else %>
      <span class="text-sm text-gray-400">No data</span>
    <% end %>
  </td>
  
  <!-- Actions -->
  <td class="px-6 py-4 text-right text-sm font-medium" data-column="actions">
    <div class="flex items-center justify-end space-x-2">
      <!-- Status Actions -->
      <% if campaign.draft? %>
        <%= button_to "Activate", campaign_path(campaign), 
                      method: :patch, 
                      params: { campaign: { status: 'active' } },
                      class: "text-green-600 hover:text-green-700 text-xs",
                      form: { "data-controller": "confirmation", "data-confirmation-message-value": "Activate this campaign?" },
                      title: "Activate campaign" %>
      <% elsif campaign.active? %>
        <%= button_to "Pause", campaign_path(campaign), 
                      method: :patch, 
                      params: { campaign: { status: 'paused' } },
                      class: "text-yellow-600 hover:text-yellow-700 text-xs",
                      form: { "data-controller": "confirmation", "data-confirmation-message-value": "Pause this campaign?" },
                      title: "Pause campaign" %>
      <% elsif campaign.paused? %>
        <%= button_to "Resume", campaign_path(campaign), 
                      method: :patch, 
                      params: { campaign: { status: 'active' } },
                      class: "text-green-600 hover:text-green-700 text-xs",
                      form: { "data-controller": "confirmation", "data-confirmation-message-value": "Resume this campaign?" },
                      title: "Resume campaign" %>
      <% end %>
      
      <!-- Dropdown Menu -->
      <div class="relative" data-controller="dropdown">
        <button type="button" 
                class="p-1 text-gray-400 hover:text-gray-600"
                data-action="click->dropdown#toggle"
                aria-haspopup="true"
                aria-expanded="false"
                aria-label="Campaign actions for <%= campaign.name %>">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"/>
          </svg>
        </button>
        
        <div class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border z-50" data-dropdown-target="menu" role="menu">
          <div class="py-1">
            <%= link_to campaign_path(campaign), 
                        class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",
                        role: "menuitem" do %>
              <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
              View Details
            <% end %>
            
            <%= link_to edit_campaign_path(campaign), 
                        class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",
                        role: "menuitem" do %>
              <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
              </svg>
              Edit Campaign
            <% end %>
            
            <%= link_to workflow_campaign_path(campaign), 
                        class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",
                        role: "menuitem" do %>
              <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
              </svg>
              View Workflow
            <% end %>
            
            <div class="border-t border-gray-100"></div>
            
            <%= link_to duplicate_campaign_path(campaign), 
                        method: :post,
                        class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",
                        role: "menuitem",
                        "data-controller": "confirmation",
                        "data-confirmation-message-value": "Duplicate this campaign?" do %>
              <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
              Duplicate
            <% end %>
            
            <% unless campaign.archived? %>
              <%= link_to archive_campaign_path(campaign), 
                          method: :patch,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",
                          role: "menuitem",
                          "data-controller": "confirmation",
                          "data-confirmation-message-value": "Archive this campaign?" do %>
                <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8l6 6 6-6"/>
                </svg>
                Archive
              <% end %>
            <% end %>
            
            <div class="border-t border-gray-100"></div>
            
            <%= link_to campaign_path(campaign), 
                        method: :delete,
                        class: "block px-4 py-2 text-sm text-red-700 hover:bg-red-50",
                        role: "menuitem",
                        "data-controller": "confirmation",
                        "data-confirmation-message-value": "Are you sure you want to delete this campaign? This action cannot be undone." do %>
              <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
              </svg>
              Delete
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </td>
</tr>