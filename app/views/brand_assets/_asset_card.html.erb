<div class="bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow duration-200"
     data-asset-type="<%= asset.asset_type %>"
     data-processing-status="<%= asset.processing_status %>"
     data-filename="<%= asset.original_filename.downcase %>">
  
  <!-- Asset Preview -->
  <div class="aspect-w-16 aspect-h-9 bg-gray-100">
    <% if asset.image? && asset.file.attached? %>
      <div class="w-full h-48 bg-gray-100 flex items-center justify-center overflow-hidden">
        <%= image_tag asset.file, 
                      class: "max-w-full max-h-full object-contain",
                      alt: asset.original_filename %>
      </div>
    <% else %>
      <div class="w-full h-48 bg-gray-100 flex items-center justify-center">
        <%= render "asset_type_icon", type: asset.asset_type, class: "w-16 h-16 text-gray-400" %>
      </div>
    <% end %>
  </div>

  <!-- Asset Info -->
  <div class="p-4">
    <!-- Header -->
    <div class="flex items-start justify-between mb-2">
      <div class="flex-1 min-w-0">
        <h3 class="text-sm font-medium text-gray-900 truncate">
          <%= asset.original_filename %>
        </h3>
        <p class="text-xs text-gray-500 mt-1">
          <%= asset.asset_type.humanize %> â€¢ <%= "%.2f MB" % asset.file_size_mb %>
        </p>
      </div>
      
      <!-- Status indicator -->
      <div class="ml-2 flex-shrink-0">
        <%= render "processing_status", status: asset.processing_status %>
      </div>
    </div>

    <!-- Metadata -->
    <div class="text-xs text-gray-500 mb-3">
      <div class="flex justify-between">
        <span>Uploaded</span>
        <time datetime="<%= asset.created_at.iso8601 %>">
          <%= time_ago_in_words(asset.created_at) %> ago
        </time>
      </div>
      <% if asset.processed_at %>
        <div class="flex justify-between mt-1">
          <span>Processed</span>
          <time datetime="<%= asset.processed_at.iso8601 %>">
            <%= time_ago_in_words(asset.processed_at) %> ago
          </time>
        </div>
      <% end %>
    </div>

    <!-- Actions -->
    <div class="flex items-center justify-between">
      <div class="flex space-x-2">
        <%= link_to brand_brand_asset_path(@brand, asset),
                    class: "text-indigo-600 hover:text-indigo-900 text-xs font-medium" do %>
          View
        <% end %>
        
        <% if asset.file.attached? %>
          <%= link_to brand_brand_asset_path(@brand, asset, format: :download),
                      class: "text-gray-600 hover:text-gray-900 text-xs font-medium",
                      method: :get do %>
            Download
          <% end %>
        <% end %>
      </div>
      
      <!-- Dropdown menu -->
      <div class="relative" data-controller="dropdown">
        <button type="button"
                class="text-gray-400 hover:text-gray-600 p-1"
                data-action="click->dropdown#toggle">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z" />
          </svg>
        </button>
        
        <div data-dropdown-target="menu"
             class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200">
          <div class="py-1">
            <%= link_to edit_brand_brand_asset_path(@brand, asset),
                        class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" do %>
              <div class="flex items-center">
                <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
                Edit
              </div>
            <% end %>
            
            <% if asset.failed? %>
              <%= link_to reprocess_brand_brand_asset_path(@brand, asset),
                          method: :post,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" do %>
                <div class="flex items-center">
                  <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                  </svg>
                  Reprocess
                </div>
              <% end %>
            <% end %>
            
            <div class="border-t border-gray-100"></div>
            
            <%= link_to brand_brand_asset_path(@brand, asset),
                        method: :delete,
                        data: { 
                          confirm: "Are you sure you want to delete this asset?",
                          turbo_method: :delete 
                        },
                        class: "block px-4 py-2 text-sm text-red-700 hover:bg-red-50" do %>
              <div class="flex items-center">
                <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
                Delete
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>